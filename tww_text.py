from tww_utils import to_hex, is_hex
from tww_table import nums_to_table

dic = {"0000": " ", "0100": "!", "0200": '"', "0300": "#", "0400": "¬•", "0500": "%", "0600": "&", "0700": "'",
       "0800": "(", "0900": ")", "0A00": "*", "0B00": "+", "0C00": ",", "0D00": "-", "0E00": ".", "0F00": "/",
       "1000": "0", "1100": "1", "1200": "2", "1300": "3", "1400": "4", "1500": "5", "1600": "6", "1700": "7",
       "1800": "8", "1900": "9", "1A00": ":", "1B00": ";", "1C00": "<", "1D00": "=", "1E00": ">", "1F00": "?",
       "2000": "@", "2100": "A", "2200": "B", "2300": "C", "2400": "D", "2500": "E", "2600": "F", "2700": "G",
       "2800": "H", "2900": "I", "2A00": "J", "2B00": "K", "2C00": "L", "2D00": "M", "2E00": "N", "2F00": "O",
       "3000": "P", "3100": "Q", "3200": "R", "3300": "S", "3400": "T", "3500": "U", "3600": "V", "3700": "W",
       "3800": "X", "3900": "Y", "3A00": "Z", "3B00": "[", "3C00": "\\", "3D00": "]", "3E00": "^", "3F00": "_",
       "4000": "`", "4100": "a", "4200": "b", "4300": "c", "4400": "d", "4500": "e", "4600": "f", "4700": "g",
       "4800": "h", "4900": "i", "4A00": "j", "4B00": "k", "4C00": "l", "4D00": "m", "4E00": "n", "4F00": "o",
       "5000": "p", "5100": "q", "5200": "r", "5300": "s", "5400": "t", "5500": "u", "5600": "v", "5700": "w",
       "5800": "x", "5900": "y", "5A00": "z", "5B00": "{", "5C00": "|", "5D00": "}", "5E00": "~", "5F00": "„ÅÅ",
       "6000": "„ÅÇ", "6100": "„ÅÉ", "6200": "„ÅÑ", "6300": "„ÅÖ", "6400": "„ÅÜ", "6500": "„Åá", "6600": "„Åà", "6700": "„Åâ",
       "6800": "„Åä", "6900": "„Åã", "6A00": "„Åå", "6B00": "„Åç", "6C00": "„Åé", "6D00": "„Åè", "6E00": "„Åê", "6F00": "„Åë",
       "7000": "„Åí", "7100": "„Åì", "7200": "„Åî", "7300": "„Åï", "7400": "„Åñ", "7500": "„Åó", "7600": "„Åò", "7700": "„Åô",
       "7800": "„Åö", "7900": "„Åõ", "7A00": "„Åú", "7B00": "„Åù", "7C00": "„Åû", "7D00": "„Åü", "7E00": "„Å†", "7F00": "„Å°",
       "8000": "„Å¢", "8100": "„Å£", "8200": "„Å§", "8300": "„Å•", "8400": "„Å¶", "8500": "„Åß", "8600": "„Å®", "8700": "„Å©",
       "8800": "„Å™", "8900": "„Å´", "8A00": "„Å¨", "8B00": "„Å≠", "8C00": "„ÅÆ", "8D00": "„ÅØ", "8E00": "„Å∞", "8F00": "„Å±",
       "9000": "„Å≤", "9100": "„Å≥", "9200": "„Å¥", "9300": "„Åµ", "9400": "„Å∂", "9500": "„Å∑", "9600": "„Å∏", "9700": "„Åπ",
       "9800": "„Å∫", "9900": "„Åª", "9A00": "„Åº", "9B00": "„ÅΩ", "9C00": "„Åæ", "9D00": "„Åø", "9E00": "„ÇÄ", "9F00": "„ÇÅ",
       "A000": "„ÇÇ", "A100": "„ÇÉ", "A200": "„ÇÑ", "A300": "„ÇÖ", "A400": "„ÇÜ", "A500": "„Çá", "A600": "„Çà", "A700": "„Çâ",
       "A800": "„Çä", "A900": "„Çã", "AA00": "„Çå", "AB00": "„Çç", "AC00": "„Çé", "AD00": "„Çè", "AE00": "„Çê", "AF00": "„Çë",
       "B000": "„Çí", "B100": "„Çì", "B200": "„Ç°", "B300": "„Ç¢", "B400": "„Ç£", "B500": "„Ç§", "B600": "„Ç•", "B700": "„Ç¶",
       "B800": "„Çß", "B900": "„Ç®", "BA00": "„Ç©", "BB00": "„Ç™", "BC00": "„Ç´", "BD00": "„Ç¨", "BE00": "„Ç≠", "BF00": "„ÇÆ",
       "C000": "„ÇØ", "C100": "„Ç∞", "C200": "„Ç±", "C300": "„Ç≤", "C400": "„Ç≥", "C500": "„Ç¥", "C600": "„Çµ", "C700": "„Ç∂",
       "C800": "„Ç∑", "C900": "„Ç∏", "CA00": "„Çπ", "CB00": "„Ç∫", "CC00": "„Çª", "CD00": "„Çº", "CE00": "„ÇΩ", "CF00": "„Çæ",
       "D000": "„Çø", "D100": "„ÉÄ", "D200": "„ÉÅ", "D300": "„ÉÇ", "D400": "„ÉÉ", "D500": "„ÉÑ", "D600": "„ÉÖ", "D700": "„ÉÜ",
       "D800": "„Éá", "D900": "„Éà", "DA00": "„Éâ", "DB00": "„Éä", "DC00": "„Éã", "DD00": "„Éå", "DE00": "„Éç", "DF00": "„Éé",
       "E000": "„Éè", "E100": "„Éê", "E200": "„Éë", "E300": "„Éí", "E400": "„Éì", "E500": "„Éî", "E600": "„Éï", "E700": "„Éñ",
       "E800": "„Éó", "E900": "„Éò", "EA00": "„Éô", "EB00": "„Éö", "EC00": "„Éõ", "ED00": "„Éú", "EE00": "„Éù", "EF00": "„Éû",
       "F000": "„Éü", "F100": "„É†", "F200": "„É°", "F300": "„É¢", "F400": "„É£", "F500": "„É§", "F600": "„É•", "F700": "„É¶",
       "F800": "„Éß", "F900": "„É®", "FA00": "„É©", "FB00": "„É™", "FC00": "„É´", "FD00": "„É¨", "FE00": "„É≠", "FF00": "„ÉÆ",
       "0001": "„ÉØ", "0101": "„É∞", "0201": "„É±", "0301": "„É≤", "0401": "„É≥", "0501": "„É¥", "0601": "„Éµ", "0701": "„É∂",
       "0801": "Àé", "0901": "À≥", "0A01": "„ÄÅ", "0B01": "Ôºé", "0C01": "¬∑", "0D01": "Ôºö", "0E01": "Ôºõ", "0F01": "Ôºü",
       "1001": "ÔºÅ", "1101": "„ÄÉ", "1201": "¬∞", "1301": " ª", "1401": " Ω", "1501": "Àµ", "1601": "‚ÅÄ", "1701": "‚Äæ",
       "1801": "„Çù", "1901": "„Çû", "1A01": "„Çü", "1B01": "‚Äì", "1C01": "‚Äî", "1D01": "‚Äê", "1E01": "Ôºè", "1F01": "‚àñ",
       "2001": "ÔΩû", "2101": "ÔΩú", "2201": "‚ãØ", "2301": "‚Äò", "2401": "‚Äô", "2501": "‚Äú", "2601": "‚Äù", "2701": "Ôºà",
       "2801": "Ôºâ", "2901": "„Äî", "2A01": "„Äï", "2B01": "Ôºª", "2C01": "ÔºΩ", "2D01": "ÔΩõ", "2E01": "ÔΩù", "2F01": "Ôºú",
       "3001": "Ôºû", "3101": "‚åà", "3201": "‚åã", "3301": "Ôºã", "3401": "Ôºç", "3501": "¬±", "3601": "√ó", "3701": "√∑",
       "3801": "Ôºù", "3901": "‚àû", "3A01": "‚à¥", "3B01": "„Ä¨", "3C01": "‚Ä≤", "3D01": "‚Ä≥", "3E01": "ÔºÜ", "3F01": "‚òÜ",
       "4001": "‚òÖ", "4101": "‚óã", "4201": "‚óè", "4301": "‚óé", "4401": "‚óá", "4501": "‚óÜ", "4601": "‚ñ°", "4701": "‚ñ†",
       "4801": "‚ñ≥", "4901": "‚ñ≤", "4A01": "‚ñΩ", "4B01": "‚ñº", "4C01": "‚Äª", "4D01": "‚ï§", "4E01": "‚Üê", "4F01": "‚Üí",
       "5001": "‚Üë", "5101": "‚Üì", "5201": "ÔºÉ", "5301": "‚ô≠", "5401": "‚ô™", "5501": "‚Ç¨", "5601": "‚Äö", "5701": "‚Äû",
       "5801": "‚ÄÄ", "5901": "Ôºæ", "5A01": "≈í", "5B01": "‚ÄÅ", "5C01": "ùë•", "5D01": "ùë°", "5E01": "‚àô", "5F01": "ÔºÇ",
       "6001": "‚Ñ¢", "6101": "‚å™", "6201": "≈ì", "6301": "¬°", "6401": "¬¢", "6501": "¬£", "6601": "‚ÄÇ", "6701": "¬©",
       "6801": "¬Æ", "6901": "ùëñ", "6A01": "ùëõ", "6B01": "‚ÄÉ", "6C01": "‚¨©", "6D01": "¬ø", "6E01": "√Ä", "6F01": "–©",
       "7001": "–™", "7101": "–´", "7201": "√Ñ", "7301": "–¨", "7401": "–≠", "7501": "√á", "7601": "√à", "7701": "√â",
       "7801": "√ä", "7901": "√ã", "7A01": "√å", "7B01": "√ç", "7C01": "√é", "7D01": "√è", "7E01": "–Æ", "7F01": "–Ø",
       "8001": "√í", "8101": "√ì", "8201": "√î", "8301": "√ï", "8401": "√ñ", "8501": "‚ÄÑ", "8601": "√ò", "8701": "√ô",
       "8801": "√ö", "8901": "√õ", "8A01": "√ú", "8B01": "√ù", "8C01": "√ü", "8D01": "√†", "8E01": "—â", "8F01": "—ä",
       "9001": "—ã", "9101": "√§", "9201": "—å", "9301": "—ç", "9401": "√ß", "9501": "√®", "9601": "√©", "9701": "√™",
       "9801": "√´", "9901": "√¨", "9A01": "√≠", "9B01": "√Æ", "9C01": "√Ø", "9D01": "—é", "9E01": "—è", "9F01": "√≤",
       "A001": "√≥", "A101": "√¥", "A201": "√µ", "A301": "√∂", "A401": "‚ÄÖ", "A501": "√∏", "A601": "√π", "A701": "√∫",
       "A801": "√ª", "A901": "√º", "AA01": "√Ω", "AB01": "‚í∂", "AC01": "‚í∑", "AD01": "‚ìç", "AE01": "‚ìé", "AF01": "‚ìÅ",
       "B001": "‚ìá", "B101": "‚úú", "B201": "‚è∞", "B301": "‚ò∫", "B401": "üò†", "B501": "üòû", "B601": "üòë", "B701": "‚òÄ",
       "B801": "‚òÅ", "B901": "‚òÇ", "BA01": "‚òÉ", "BB01": "‚ùó", "BC01": "‚ùì", "BD01": "‚úâ", "BE01": "üì±", "BF01": "‚äû",
       "C001": "‚ô†", "C101": "‚ô¶", "C201": "‚ô•", "C301": "‚ô£", "C401": "‚ûù", "C501": "ü†î", "C601": "ü†ï", "C701": "ü†ó",
       "C801": "‚ï≥", "C901": "‚ÄÜ", "CA01": "Ôºê", "CB01": "Ôºë", "CC01": "Ôºí", "CD01": "Ôºì", "CE01": "Ôºî", "CF01": "Ôºï",
       "D001": "Ôºñ", "D101": "Ôºó",  "D201": "Ôºò", "D301": "Ôºô", "D401": "–ê", "D501": "–ë", "D601": "–í", "D701": "–ì",
       "D801": "–î", "D901": "–ï", "DA01": "–Å", "DB01": "–ñ", "DC01": "–ó", "DD01": "–ò", "DE01": "–ô", "DF01": "–ö",
       "E001": "–õ", "E101": "–ú", "E201": "–ù", "E301": "–û", "E401": "–ü", "E501": "–†", "E601": "–°", "E701": "–¢",
       "E801": "–£", "E901": "–§", "EA01": "–•", "EB01": "–¶", "EC01": "–ß", "ED01": "–®", "EE01": "–∞", "EF01": "–±",
       "F001": "–≤", "F101": "–≥", "F201": "–¥", "F301": "–µ", "F401": "—ë", "F501": "–∂", "F601": "–∑", "F701": "–∏",
       "F801": "–π", "F901": "–∫", "FA01": "–ª", "FB01": "–º", "FC01": "–Ω", "FD01": "–æ", "FE01": "–ø", "FF01": "—Ä",
       "0002": "—Å", "0102": "—Ç", "0202": "—É", "0302": "—Ñ", "0402": "—Ö", "0502": "—Ü", "0602": "—á", "0702": "—à",
       "0802": "„Äú", "0902": "„Äé", "0A02": "„Äè", "0B02": "„Äñ", "0C02": "„Äó", "0D02": "ÔºÖ", "0E02": "‚àö", "0F02": "Ôº†",
       "1002": "‚Ö†", "1102": "‚Ö°", "1202": "‚Ö¢", "1302": "‚Ö£", "1402": "‚Ö§", "1502": "‚Ö•", "1602": "‚Ö¶", "1702": "‚Öß",
       "1802": "‚Ö®", "1902": "‚Ö©", "1A02": "‚ì™", "1B02": "‚ë†", "1C02": "‚ë°", "1D02": "‚ë¢", "1E02": "‚ë£", "1F02": "‚ë§",
       "2002": "‚ë•", "2102": "‚ë¶", "2202": "‚ëß", "2302": "‚ë®", "2402": "‚ë©", "2502": "Ôºø", "2602": "$", "2702": "üÑ∏",
       "2802": "üÑæ", "2902": "üÖÉ", "2A02": "üÜÉ", "2B02": "üÜÇ", "2C02": "üÖ≥", "2D02": "üÖ∫", "2E02": "üÖ≤", "2F02": "üÖº",
       "3002": "üÜÅ", "3102": "üÖø", "3202": "üÖ±", "3302": "üÖ∞", "3402": "üÖÜ", "3502": "üÖá", "FEFF": "\t", "FFFF": "\n",
       "B6FF": "üîµ", "BAFF": "üü¢", "BCFF": "üî¥", "BEFF": "‚ö´"}

#unpacks the text
def unpack():
    with open(r"root\root\Apl_Fuk\mestxt.bin", "rb") as file:
        a = to_hex(file.read())
        print(a)

    with open("twewytext.txt", "w", encoding="utf-8") as file1:
        for i in a:
            if i.upper() in dic.keys():
                file1.write(dic[i.upper()])
            else:
                file1.write("‚ùÑ" + i + "‚ùÑ")

#packs the text
def pack():
    res = ""
    with open("twewytext.txt", encoding="utf-8") as file2:
        read1 = file2.read()
        read1 = read1.replace("‚Ä¶", "...")
        with open("mstbl.txt", "w") as table:
            for i in read1.split("\n")[:-1]:
                table.write(str(len(i) - (int(i.count("‚ùÑ") * 5 / 2)) + 1) + "\n")
        print("—Ç–∞–±–ª–∏—Ü–∞ –≥–æ—Ç–æ–≤–∞!")
        lst = list(filter(lambda x: len(x) > 0, read1.split("‚ùÑ")))
        for i in lst:
            if len(i) == 4 and is_hex(i):
                print(i, end="")
                res += i
            else:
                for j in i:
                    print(j, end="")
                    res += list(dic.keys())[list(dic.values()).index(j)]
        with open("mestxt.bin", "wb") as file3:
            file3.write(bytes.fromhex(res))
        nums_to_table("mstbl.txt", "mestable.bin")


unpack()